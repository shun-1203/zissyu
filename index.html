<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>忘れ物・落とし物共有アプリ</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <h1>忘れ物・落とし物共有アプリ</h1>
  <button id="getProfile" disabled>LINEログイン & プロフィール取得</button>
  <div id="output"></div>

  <script>
    const liffId = "2008097109-4gW3w9Xg"; // あなたのLIFF ID

    async function main() {
      try {
        await liff.init({ liffId });

        if (!liff.isLoggedIn()) {
          liff.login();
          return; // ログイン後は自動でリロードされるのでここで終了
        }

        // ログイン済みならボタンを有効化
        document.getElementById("getProfile").disabled = false;

        document.getElementById("getProfile").onclick = async () => {
          try {
            const profile = await liff.getProfile();
            document.getElementById("output").innerHTML =
              `<p>こんにちは、${profile.displayName} さん！</p>
               <img src="${profile.pictureUrl}" width="100">`;
          } catch (err) {
            console.error("プロフィール取得失敗:", err);
          }
        };

      } catch (error) {
        console.error("LIFF init エラー:", error);
      }
    }

    main();
  </script>
</body>
</html>

